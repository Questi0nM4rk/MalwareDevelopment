#pragma once

#include <windows.h>
#include <wlanapi.h>
#include <tchar.h>
#include <stdio.h>

#define WLAN_API_VERSION_2 2
#define WLAN_PROFILE_GET_PLAINTEXT_KEY 0x00000004

HANDLE open_wlan_handle(DWORD api_version);
PWLAN_INTERFACE_INFO_LIST enum_wlan_interfaces(HANDLE handle);
PWLAN_PROFILE_INFO_LIST grab_interface_profiles(HANDLE handle, GUID interface_guid);
BSTR extract_pass_from_xml(const BSTR xml_data);
void get_plain_text_pass(HANDLE handle, GUID interface_guid, LPCWSTR profile_name);
